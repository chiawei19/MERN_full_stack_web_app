{"version":3,"sources":["webpack:///./src/SignInNavItem.jsx"],"names":["SigninNavItem","React","Component","constructor","props","state","showing","disabled","user","signedIn","givenName","showModal","bind","hideModal","signOut","signIn","componentDidMount","clientId","window","ENV","GOOGLE_CLIENT_ID","console","log","object","gapi","load","auth2","getAuthInstance","init","client_id","then","setState","showError","googleUser","getBasicProfile","getGivenName","error","render","withToast"],"mappings":"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","file":"server.a084363a4665931876f8.hot-update.js","sourcesContent":["import React from 'react';\nimport {\n  NavItem, Modal, Button, NavDropdown, MenuItem,\n} from 'react-bootstrap';\n\nimport withToast from './withToast.jsx';\n\nclass SigninNavItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showing: false,\n      disabled: true,\n      user: { signedIn: false, givenName: '' },\n    };\n    this.showModal = this.showModal.bind(this);\n    this.hideModal = this.hideModal.bind(this);\n    this.signOut = this.signOut.bind(this);\n    this.signIn = this.signIn.bind(this);\n  }\n\n  componentDidMount() {\n    const clientId = window.ENV.GOOGLE_CLIENT_ID;\n    console.log(object);\n    if (!clientId) return;\n    window.gapi.load('auth2', () => {\n      if (!window.gapi.auth2.getAuthInstance()) {\n        window.gapi.auth2.init({ client_id: clientId }).then(() => {\n          this.setState({ disabled: false });\n        });\n      }\n    });\n  }\n\n  async signIn() {\n    this.hideModal();\n    const { showError } = this.props;\n    try {\n      const auth2 = window.gapi.auth2.getAuthInstance();\n      const googleUser = await auth2.signIn();\n      const givenName = googleUser.getBasicProfile().getGivenName();\n      this.setState({ user: { signedIn: true, givenName } });\n    } catch (error) {\n      showError(`Error authenticating with Google: ${error.error}`);\n    }\n  }\n\n  signOut() {\n    this.setState({ user: { signedIn: false, givenName: '' } });\n  }\n\n  showModal() {\n    const clientId = window.ENV.GOOGLE_CLIENT_ID;\n    const { showError } = this.props;\n    if (!clientId) {\n      showError('Missing environment variable GOOGLE_CLIENT_ID');\n      return;\n    }\n    this.setState({ showing: true });\n  }\n\n  hideModal() {\n    this.setState({ showing: false });\n  }\n\n  render() {\n    const { user } = this.state;\n    if (user.signedIn) {\n      return (\n        <NavDropdown title={user.givenName} id=\"user\">\n          <MenuItem onClick={this.signOut}>Sign out</MenuItem>\n        </NavDropdown>\n      );\n    }\n\n    const { showing, disabled } = this.state;\n    return (\n      <>\n        <NavItem onClick={this.showModal}>\n          Sign in\n        </NavItem>\n        <Modal keyboard show={showing} onHide={this.hideModal} bsSize=\"sm\">\n          <Modal.Header closeButton>\n            <Modal.Title>Sign in</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Button\n              block\n              disabled={disabled}\n              bsStyle=\"primary\"\n              onClick={this.signIn}\n            >\n              <img src=\"https://goo.gl/4yjp6B\" alt=\"Sign In\" />\n            </Button>\n          </Modal.Body>\n          <Modal.Footer>\n            <Button bsStyle=\"link\" onClick={this.hideModal}>Cancel</Button>\n          </Modal.Footer>\n        </Modal>\n      </>\n    );\n  }\n}\nexport default withToast(SigninNavItem);\n"],"sourceRoot":""}